import re

def extract_age(text: str) -> int:
    """
    Извлекает возраст в годах из текстовой строки.
    Парсит первое найденное число, за которым следуют слова 'год', 'года' или 'лет'.
    Возвращает 30, если возраст не найден (значение по умолчанию).

    Args:
        text: Входная строка, содержащая информацию о возрасте (например, 'Мужчина, 42 года').

    Returns:
        Возраст в годах (int).
    """
    if not isinstance(text, str):
        return 30
    match = re.search(r'(\d+)\s+(?:год|года|лет)', text)
    return int(match.group(1)) if match else 30

def extract_experience(text: str) -> int:
    """
    Извлекает опыт работы из текстовой строки и конвертирует его в общее количество месяцев.
    Парсит числа перед словами 'год/лет/года' и 'месяц/месяца/месяцев'.
    Включает эвристику для фильтрации дат (например, '2019 год' вместо '2019 лет').
    Возвращает 0, если опыт не указан или не может быть извлечен.

    Args:
        text: Входная строка с информацией об опыте работы (например, '5 лет 2 месяца').

    Returns:
        Общее количество месяцев опыта (int).
    """
    s = str(text).lower()
    if s == 'nan' or 'не указано' in s:
        return 0

    years_match = re.search(r'(\d+)\s+(?:год|года|лет)', s)
    months_match = re.search(r'(\d+)\s+(?:месяц|месяца|месяцев)', s)

    years = int(years_match.group(1)) if years_match else 0
    months = int(months_match.group(1)) if months_match else 0

    # Эвристика: если число лет выглядит как год (например, 2019), сбрасываем его
    if years > 100:
        years = 0

    return years * 12 + months

def extract_salary(text: str) -> float:
    """
    Извлекает числовое значение зарплаты из текстовой строки.
    Удаляет все нецифровые символы и конвертирует результат в float.
    Возвращает 0.0, если зарплата не указана или не может быть извлечена.

    Args:
        text: Входная строка с информацией о зарплате (например, '100 000 руб.').

    Returns:
        Числовое значение зарплаты (float).
    """
    if not isinstance(text, str):
        return 0.0
    num = re.sub(r'[^\d]', '', text) # Удаляем все, кроме цифр
    return float(num) if num else 0.0